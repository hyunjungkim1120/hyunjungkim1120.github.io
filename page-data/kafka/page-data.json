{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/kafka",
    "result": {"data":{"markdownRemark":{"id":"e5656c51-188c-522e-a556-b8ad7008d370","html":"<h2>Apache Kafka</h2>\n<p>ì¹´í”„ì¹´ë¥¼ ê²€ìƒ‰í•˜ë©´ ë‚˜ì˜¤ëŠ” ì„¤ëª…ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p>\n<p> <em>ì•„íŒŒì¹˜ ì¹´í”„ì¹´ëŠ” ì•„íŒŒì¹˜ ì†Œí”„íŠ¸ì›¨ì–´ ì¬ë‹¨ì´ ìŠ¤ì¹¼ë¼ë¡œ ê°œë°œí•œ ì˜¤í”ˆ ì†ŒìŠ¤ ë©”ì‹œì§€ ë¸Œë¡œì»¤ í”„ë¡œì íŠ¸ì´ë‹¤.</em>\n<em>ì´ í”„ë¡œì íŠ¸ëŠ” ì‹¤ì‹œê°„ ë°ì´í„° í”¼ë“œë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ í†µì¼ëœ, ë†’ì€ ì²˜ë¦¬ëŸ‰, ë‚®ì€ ì§€ì—°ì‹œê°„ì„ ì§€ë‹Œ í”Œë«í¼ì„ ì œê³µí•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.</em></p>\n<p>ğŸ’¡ <strong>ì‰½ê²Œ ë§í•´ì„œ ì¹´í”„ì¹´ëŠ” ë¶„ì‚°í™˜ê²½ì— íŠ¹í™”ë˜ì–´ìˆëŠ” \"ë©”ì‹œì§€ í\" ì´ë‹¤.</strong></p>\n</br>\n</br>\n</br>\n<p>Kafkaì™€ í•¨ê»˜ ìì£¼ ì–¸ê¸‰ë˜ëŠ” ë©”ì‹œì§• ì‹œìŠ¤í…œì€ RabbitMQ, ActiveMQ ë“±ì´ ìˆë‹¤. ì ê¹ Kafkaë¥¼ ë‹¤ë¥¸ ë©”ì‹œì§• ì‹œìŠ¤í…œê³¼ ë¹„êµí•´ë³´ê³  ë„˜ì–´ê°€ì.</p>\n<ul>\n<li>KafkaëŠ” Message Brokerê°€ Consumerì—ê²Œ ë©”ì‹œì§€ë¥¼ pushí•˜ëŠ” ë°©ì‹ì˜ RabbitMQì™€ëŠ” ë‹¬ë¦¬ Consumerê°€ Brokerë¡œ ë¶€í„° ë©”ì‹œì§€ë¥¼ Pullí•˜ëŠ” ë°©ì‹ì´ë‹¤. Consumerê°€ ë©”ì‹œì§€ë¥¼ Pullí•˜ëŠ” ì¹´í”„ì¹´ì˜ ë°©ì‹ì€ Consumerì—ê²Œ ë¶€í•˜ë¥¼ ìƒëŒ€ì ìœ¼ë¡œ ëœ ì£¼ë©° ConsumerëŠ” ìì‹ ì´ ì²˜ë¦¬í•  ìˆ˜ ìˆì„ ë•Œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì˜¤ë¯€ë¡œ ìì›ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.</li>\n<li>ë§ì€ ì‚¬ëŒë“¤ì´ ê³µí†µì ìœ¼ë¡œ ë§í•˜ëŠ” kafka ì˜ ì¥ì ì€ í¬ê²Œ <strong>1.ë°ì´í„°ì˜ ì˜ì†ì„± ë³´ì¥ 2. ë©”ì‹œì§€ ìœ ì‹¤ìœ„í—˜ì´ ì ê³  ì—ëŸ¬ë³µêµ¬ìš©ì´, ì‹¤ì‹œê°„ ë¡œê·¸ì²˜ë¦¬ì— íŠ¹í™”</strong> ë¼ê³  ì´ì•¼ê¸°í•œë‹¤. </li>\n</ul>\n</br>\n</br>\n<p>ì¹´í”„ì¹´ì˜ êµ¬ì„±ìš”ì†Œë¡œëŠ” í¬ê²Œ <strong>Producer, Consumer, Event , Topic</strong> ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.</p>\n</br>\n</br>\n<p><strong>Producer</strong>  : ì›í•˜ëŠ” <strong>Topic</strong>ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¸ë‹¤. </p>\n<p><strong>Consumer</strong> : ë ˆì½”ë“œ/ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì—”í„°í‹°ì´ë‹¤. ì—¬ëŸ¬ê°œì˜ Consumerê°€ ê·¸ë£¹ ë¬¶ì–´ì„œ êµ¬ì„±ë˜ì–´ìˆìœ¼ë©° í•˜ë‚˜ì˜ Consumer ê·¸ë£¹ì€ í•˜ë‚˜ì˜ Topicì—ë§Œ ì ‘ê·¼í•˜ì—¬ ë©”ì„¸ì§€ë¥¼ Pull í•œë‹¤.</p>\n<ul>\n<li>ì—¬ê¸°ì„œ Topic ê¸°ì¤€ìœ¼ë¡œ ìƒê°í•˜ë©´ ì—¬ëŸ¬ê°œì˜ Consumer ê·¸ë£¹ì´ í•˜ë‚˜ì˜ í† í”½ì„ êµ¬ë…í•  ìˆ˜ ìˆë‹¤!</li>\n</ul>\n<p><strong>Topic</strong> : Apache Kafka ë° ê¸°íƒ€ ë©”ì‹œì§• ì†”ë£¨ì…˜ì—ì„œ í† í”½ì€ ë©”ì‹œì§€ì— ëŒ€í•œ ê´€ì‹¬ì„ í‘œì‹œí•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì£¼ì†Œ ì§€ì •ì´ ê°€ëŠ¥í•œ ì¶”ìƒí™” ê³„ì¸µì´ë‹¤. í† í”½ì€ ê²Œì‹œ(Publish) ë° êµ¬ë…(Subscribe)í•  ìˆ˜ ìˆë‹¤.</p>\n<p>ë‹¤ì‹œí•œë²ˆ ì‰½ê²Œ í’€ì–´ì„¤ëª…í•˜ìë©´ ProducerëŠ” ë©”ì„¸ì§€ë¥¼ ë³´ë‚´ê³  ConsumerëŠ” ë©”ì„¸ì§€ë¥¼ êº¼ë‚´ì˜¨ë‹¤!</p>\n</br>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 861px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.79687500000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'168\\'%20viewBox=\\'0%200%20400%20168\\'%20preserveAspectRatio=\\'none\\'/%3e'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"kafka_example\"\n        title=\"kafka_example\"\n        src=\"/static/37c597f34f7ec6615ffc1a7684e56edd/e35ec/kafka_example.png\"\n        srcset=\"/static/37c597f34f7ec6615ffc1a7684e56edd/6f3f2/kafka_example.png 256w,\n/static/37c597f34f7ec6615ffc1a7684e56edd/01e7c/kafka_example.png 512w,\n/static/37c597f34f7ec6615ffc1a7684e56edd/e35ec/kafka_example.png 861w\"\n        sizes=\"(max-width: 861px) 100vw, 861px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">kafka_example</figcaption>\n  </figure></p>\n</br>\n<p><a href=\"https://github.com/confluentinc/examples/tree/6.2.0-post/clients/cloud\">https://github.com/confluentinc/examples/tree/6.2.0-post/clients/cloud</a></p>\n<p>í•´ë‹¹ ì£¼ì†Œì— ê° ì–¸ì–´ì— ë§ëŠ” ìƒ˜í”Œ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì—¬ ê°ìì˜ ìƒí™©ì— ë§ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>\n</br>\n</br>\n<p>ì•„ë˜ëŠ” C#ìœ¼ë¡œ ì¹´í”„ì¹´ Cunsumerë¥¼ ì‘ì„±í•œ ì˜ˆì‹œì´ë‹¤. Confluent.Kafka 1.7.0ì„ Nugetì—ì„œ ë‹¤ìš´ë°›ì•˜ë‹¤. ê·¸ë¦¬ê³  ë”°ë¡œ ConsumerConfig íŒŒì¼ì„ ì‘ì„±í•˜ì—¬ ì„¤ì • ê°’ë“¤ì„ ì‘ì„±í•˜ì˜€ë‹¤. ë§Œì•½ ë”°ë¡œ ì„¤ì • íŒŒì¼ì„ ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤ë©´ region ConsumerConfig ê°€ì ¸ì˜¤ê¸° ~endregion ë¶€ë¶„ì— ê°ê° í•´ë‹¹ ë³€ìˆ˜ì— ê°’ì„ í• ë‹¹í•˜ë©´ ëœë‹¤.</p>\n</br>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">public Task GetKafkaMessage()\n        {\n            #region ConsumerConfig ê°€ì ¸ì˜¤ê¸°\n            var config = new ConsumerConfig\n            {\n                GroupId = _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:GroupId&quot;),\n                BootstrapServers = _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:BootstrapServers&quot;),\n                SaslUsername = _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:SaslUsername&quot;),\n                SaslPassword = _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:SaslPassword&quot;),\n                SecurityProtocol = (SecurityProtocol)Enum.Parse(typeof(SecurityProtocol), _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:SecurityProtocol&quot;)),\n                SaslMechanism = (SaslMechanism)Enum.Parse(typeof(SaslMechanism), _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:SaslMechanism&quot;)),\n                AutoOffsetReset = (AutoOffsetReset)Enum.Parse(typeof(AutoOffsetReset), _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:AutoOffsetReset&quot;)),\n\n            };\n            #endregion ConsumerConfig ê°€ì ¸ì˜¤ê¸°\n\n            using (var consumer = new ConsumerBuilder&lt;string, string&gt;(config)\n                .SetErrorHandler((_, e) =&gt; _logger.LogWarning($&quot;Error: {e.Reason}&quot;))\n                .Build())\n            {\n                string topic = _configuration.GetValue&lt;string&gt;(&quot;KafkaConfig:topic&quot;);\n                consumer.Subscribe(topic);\n\n                List&lt;string&gt; InsertDataList = new List&lt;string&gt;();\n                String message = &quot;&quot;;\n                DateTime LastUpdateDate = DateTime.Now;\n\n                try\n                {\n                    while (true)\n                    {\n                        try\n                        {\n                            #region ì¼ì •ì‹œê°„, listQty ì´ˆê³¼ì‹œ ë¡œê·¸\n                            TimeSpan diffDate = DateTime.Now - LastUpdateDate;\n\n                            //ë§ˆì§€ë§‰ updateì‹œê°„ì´ 3ì´ˆ ì§€ë‚¬ê±°ë‚˜ ë°ì´í„°ê°€ 10ê±´ì´ìƒì´ë©´\n                            if (InsertDataList.Count&gt;0 &amp;&amp; (diffDate.Seconds &gt; 3 || InsertDataList.Count &gt;= 10))\n                            {\n                                foreach (var data in InsertDataList)\n                                {\n\t\t\t\t\t\t\t\t\t_logger.LogInformation(data);\n                                }\n                                InsertDataList.Clear();\n                            }\n                            #endregion ì¼ì •ì‹œê°„, listQty ì´ˆê³¼ì‹œ ë¡œê·¸\n\n                            var consumeResult = consumer.Consume(5000);\n                           \n                            //brokerì—ì„œ ê°€ì ¸ì˜¨ dataê°€ ìˆëŠ” ê²½ìš°\n                            if(consumeResult != null)\n                            {\n                                message = consumeResult.Value;\n                                InsertDataList.Add(message);\n                            }\n                        }\n                        catch (ConsumeException e)\n                        {\n                            _logger.LogWarning($&quot;Error occurred: {e.Error.Reason}&quot;);\n                        }\n                    }\n                }\n                catch (Exception e)\n                {\n                    _logger.LogWarning($&quot;Exception occurred: {e.Message}&quot;);\n                    consumer.Close();\n                }\n            }\n            return Task.CompletedTask;\n        }</code></pre></div>\n</br>\n</br>\n</br>\n<p>Producerë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” ë¶€ë¶„ì€ Serilogë¡œ ë¡œê·¸ë¥¼ ì „ì†¡í•˜ì˜€ë‹¤.</p>\n<ul>\n<li>Serilog >v2.9.0</li>\n<li>Serilog.Sinks.PeriodicBatching >v2.3.0</li>\n<li>Confluent.Kafka >v1.6.3</li>\n</ul>\n<p>ìœ„ì˜ ì¡°ê±´ì„ ì¤€ìˆ˜í•˜ì—¬ íŒ¨í‚¤ì§€ë¥¼ ë°›ê³  ì•„ë˜ì²˜ëŸ¼ ì„¤ì • í›„ í”„ë¡œê·¸ë¨ ì‹¤í–‰ ë¡œê·¸ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">try\n{\n\t//kafka Log ì „ì†¡ ì„¤ì •\n\tkafkaLogger = new LoggerConfiguration()\n\t\t\t\t.WriteTo.Kafka(\n\t\t\t\t\t\tbatchSizeLimit: 10, period: 2,\n                        topic: &quot;log-events&quot;,\n                        bootstrapServers: &quot;ì„œë²„ ì£¼ì†Œ&quot;, \n                        saslMechanism: SaslMechanism.Plain,\n                        securityProtocol: SecurityProtocol.SaslPlaintext,\n                        saslUsername: &quot;$ConnectionString&quot;,\n                        saslPassword: &quot;my-event-hub-instance-connection-string&quot;\n                    .CreateLogger();\n} catch (Exception ex)\n{\n\t_logger.Warning(&quot;kafka connection error, Message : {0}&quot;, ex.Message);\n}</code></pre></div>\n</br>\n<h4>Parameters</h4>\n<ul>\n<li><strong>bootstrapServers</strong> - Comma separated list of Kafka Bootstrap Servers. Defaults to \"localhost:9092\"</li>\n<li><strong>batchSizeLimit</strong> - Maximum number of logs to batch. Defaults to 50</li>\n<li><strong>period</strong> - The period in seconds to send batches of logs. Defaults to 5 seconds</li>\n<li><strong>securityProtocol</strong> - SecurityProtocol.Plaintext</li>\n<li><strong>saslMechanism</strong> - The SASL Mecahnism. Defaults to SaslMechanism.Plain</li>\n<li><strong>topic</strong> - Name of the Kafka topic. Defaults to \"logs\"</li>\n<li><strong>topicDecider</strong> - Alternative to a static/constant \"topic\" value. Function that can be used to determine the topic to be written to at runtime (example below)</li>\n<li><strong>saslUsername</strong> - (Optional) Username for SASL. This is required for Azure Event Hubs and should be set to <code class=\"language-text\">$ConnectionString</code></li>\n<li><strong>saslPassword</strong> - (Optional) Password for SASL. This is required for Azure Event Hubs and is your entire Connection String.</li>\n<li><strong>sslCaLocation</strong> - (Optional) Location of the SSL CA Certificates This is required for Azure Event Hubs and should be set to <code class=\"language-text\">./cacert.pem</code> as this package includes the Azure carcert.pem file which is copied into your binary output directory.</li>\n<li><strong>formatter</strong> - optional <code class=\"language-text\">ITextFormatter</code> you can specify to format log entries. Defaults to the standard <code class=\"language-text\">JsonFormatter</code> with <code class=\"language-text\">renderMessage</code> set to <code class=\"language-text\">true</code>.</li>\n</ul>\n</br>\n</br>\n</br>\n<p>ì‚¬ì‹¤ ë” ê¹Šê²Œ ì•Œê³ ì í•˜ë©´ KafkaëŠ” Commit Offsetì„ ì–´ë–»ê²Œ ì œì–´í•˜ëŠ”ê°€ë¡œ ì „ë‹¬ë³´ì¦ì„ í™•ì‹¤íˆ ì œì–´í•˜ê¸°ë„ í•˜ëŠ” ë“± </p>\n<p>ìì„¸íˆ ì•Œê³  ì“¸ìˆ˜ë¡ ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ë‚˜ ì‘ë‹µì†ë„ê°€ ì¤‘ìš”í•œ ì„œë¹„ìŠ¤ì—ì„œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤!</p>\n</br>\n<p>í•˜ë‹¨ì˜ ì£¼ì†ŒëŠ” Kafkaë¥¼ ì´í•´í•˜ëŠ”ë° ìˆì–´ì„œ ìœ ìš©í•œ ë§í¬ì´ë‹¤.</p>\n<p><a href=\"https://t3guild.com/2020/04/18/kafka-%ea%b0%9c%ec%9a%94/\">https://t3guild.com/2020/04/18/kafka-%ea%b0%9c%ec%9a%94/</a></p>\n</br>","excerpt":"Apache Kafkaâ€¦","frontmatter":{"date":"September 09, 2021","slug":"/kafka","title":"Kafka","description":"Apache Kafka ê°œë…ì´í•´ ë° ì‚¬ìš© (c#)","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/d083d6f608229b6113f03ad6d3649038/e6ff9/kafka.jpg","srcSet":"/static/d083d6f608229b6113f03ad6d3649038/06a47/kafka.jpg 750w,\n/static/d083d6f608229b6113f03ad6d3649038/3c27a/kafka.jpg 1080w,\n/static/d083d6f608229b6113f03ad6d3649038/28136/kafka.jpg 1366w,\n/static/d083d6f608229b6113f03ad6d3649038/e6ff9/kafka.jpg 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/d083d6f608229b6113f03ad6d3649038/45f0d/kafka.webp 750w,\n/static/d083d6f608229b6113f03ad6d3649038/eedfa/kafka.webp 1080w,\n/static/d083d6f608229b6113f03ad6d3649038/e048d/kafka.webp 1366w,\n/static/d083d6f608229b6113f03ad6d3649038/f594a/kafka.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5593750000000001}}}}}},"pageContext":{"id":"e5656c51-188c-522e-a556-b8ad7008d370","previous":{"id":"3d041fe0-2b2c-5e43-a482-75bf4841fb87","frontmatter":{"slug":"/jmeter","template":"blog-post","title":"Jmeter ì„±ëŠ¥í…ŒìŠ¤íŠ¸"}},"next":{"id":"b5b295a2-5b99-593f-b22b-b8b30180fb51","frontmatter":{"slug":"/redis","template":"blog-post","title":"redis (1)"}}}},
    "staticQueryHashes": ["228695001","2744905544","358227665"]}